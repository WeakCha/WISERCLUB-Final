<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta name="generator" content="jemdoc, see http://jemdoc.jaboc.net/" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link rel="stylesheet" href="jemdoc.css" type="text/css" />
<title></title>
</head>
<body>
<table summary="Table for page layout." id="tlayout">
<tr valign="top">
<td id="layout-menu">
<div class="menu-category">WISERCLUB <br/> 2019-2020 Final</div>
<div class="menu-item"><a href="index.html" >Introduction</a></div>
<div class="menu-item"><a href="Project.html">Project&nbsp;Description</a></div>
<div class="menu-item"><a href="Experiments.html">Numerical Experiments</a></div>
<div class="menu-item"><a href="hint.html" class="current">Hints</a></div>
</td>
<td id="layout-content">
<div id="layout-content">
<div class="infoblock">
<div class="blocktitle">Preparation and Read Files</div>
<div class="blockcontent">
<p>You should import some important packages first. For encoding reasons, you should use UTF-8. In Python, it means
</p>
</div></div>
<div class="codeblock">
<div class="blockcontent"><pre>
import pandas as pd
import numpy as np

Data = pd.read_csv("data.csv", encoding = "UTF-8")
</pre></div></div>
<p>
</p>
<h2>Part 1: Explorative Data Analysis
</h2>
<div class="infoblock">
<div class="blocktitle">Problem 1</div>
<div class="blockcontent">
<p>You could use Aggregate Functions (<tt>groupby</tt> in <tt>Pandas</tt>) or just loops to find the first and last day of the orders in this dataset (For loop is very time-consuming, I will not mention it later). <br /> One example is shown below.
</p>
</div></div>
<div class="codeblock">
<div class="blockcontent"><pre>
'''
        date	order_id	commodity_code	commodity_name	category_name
0	2019/6/1	1	S1	标准美式	饮品
7	2019/6/21	8	S11	坚果	食品
1	2019/7/2	2	S2	瑞纳冰	饮品
5	2019/6/13	6	S2	瑞纳冰	饮品
2	2019/6/6	3	S3	加浓美式	饮品
3	2019/6/17	4	S5	拿铁	饮品
4	2019/7/4	5	S5	拿铁	饮品
6	2019/6/14	7	S9	菠萝卷	食品
8	2019/6/17	9	S9	菠萝卷	食品
'''
</pre></div></div>
<p>
</p>
<div class="infoblock">
<div class="blockcontent">
<p>For the dataset above, the output result should be 
</p>
</div></div>
<div class="codeblock">
<div class="blockcontent"><pre>
'2019/6/1' to '2019/7/4'
</pre></div></div>
<p>
</p>
<div class="infoblock">
<div class="blocktitle">Problem 2</div>
<div class="blockcontent">
<p>Find the <i>time</i> feature and use <tt>groupby</tt>, then compute the number of orders by <tt>sum</tt> in <tt>Pandas</tt>
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 2-a</div>
<div class="blockcontent">
<p>Show that there is a significant difference in the number of orders in Workdays and Weekends.
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 3</div>
<div class="blockcontent">
<p>Similar to Problem 2 except that you need to find a <i>user</i> feature.
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 4</div>
<div class="blockcontent">
<p>Use <tt>groupby</tt> with respect to <i>commodity_code</i> or <i>commodity_name</i> and <tt>sort_values</tt> in <tt>Pandas</tt>. <br /> 

For graphs, see codes below.
</p>
</div></div>
<div class="codeblock">
<div class="blockcontent"><pre>
import matplotlib as plt
plt.figure(figsize = ..., dpi = ...)
plt.bar(Index, Values)
plt.show()

<span class = "comment"># OR</span>

import seaborn as sns
sns.barplot(data = ...)
</pre></div></div>
<p>
</p>
<div class="infoblock">
<div class="blocktitle">Problem 5: Hints 1</div>
<div class="blockcontent">
<p>Here is the key: Try to shuffle some samples, compute the discount rate and the results should be 0, 0.18, 0.28, 0.38, 0.5, 0.66 and so on. This is because these are the true discount rates appeared in the coupons. <br />

Formula: <i>commodity_income</i> ( or <i>pay_money + coffeestore_share_money </i> ) / <i>commodity_origin_money</i>
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 5: Hints 2</div>
<div class="blockcontent">
<p>In Pandas, you could do direct computations between different <tt>Series</tt>. 

<br /> Here is an example.
</p>
</div></div>
<div class="codeblock">
<div class="blockcontent"><pre>
A = pd.DataFrame([1,2,3], columns = ['A'])
B = pd.DataFrame([4,5,6], columns = ['B'])

print (A['A'] + B['B'])
'''
Result:
0    5
1    7
2    9
dtype: int64
'''
</pre></div></div>
<p>
</p>
<div class="infoblock">
<div class="blocktitle">Problem 6</div>
<div class="blockcontent">
<p>Use <tt>groupby</tt> in <tt>Pandas</tt> and <tt>mean()</tt> methods to find the average. <br /> As for the <i>week</i>, although it is acceptable to look up in the calender, you'd better use <i>holiday.csv</i> to find which seven days could be combined into one <i>week</i>.
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 7</div>
<div class="blockcontent">
<p>Obtain the users on the day <tt>t</tt> and use the users indices to do filtering by <tt>.isin()</tt> method. <br />

For <tt>.isin()</tt>, here is an example.
</p>
</div></div>
<div class="codeblock">
<div class="blockcontent"><pre>
A = pd.DataFrame([1,2,2,3,4,5,6,7,9,10,2,7], columns = ['A'])
B = [1,2,3]
print(A['A'].loc[A['A'].isin(B)])

'''
Result:
0     1
1     2
2     2
3     3
10    2
Name: A, dtype: int64
'''
</pre></div></div>
<p>
</p>
	<div class="infoblock">
<div class="blockcontent">
<p>Please keep in mind the difference between <tt>.loc()</tt> and <tt>.iloc()</tt>
</p>
</div></div>
	<div class="infoblock">
<div class="blocktitle">Problem 8</div>
<div class="blockcontent">
	<p>Let time be <tt> t </tt>, then you need to find the users buying at time <tt> t </tt> first, and find users buying within next seven days ( <tt>[t+1, t+7] </tt>) and use <tt>.isin() </tt> method to do filtering. <br />
		For example, if 100 customers bought products on 02-01, 50 of them bought products within the next seven days, then the answer is 0.5.
</p>
</div></div>
	
<div class="infoblock">
<div class="blocktitle">Problem 9-10</div>
<div class="blockcontent">
	<p>Just notice that there are many new definitions such as <i>new users</i>, so you need more caution for this problem. 
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 11</div>
<div class="blockcontent">
<p>This could be done by Logic Expression, here is an example. 
</p>
</div></div>
<div class="codeblock">
<div class="blockcontent"><pre>
A = pd.DataFrame([1,2,2,3,4,5,6,7,9,10,2,7], columns = ['A'])
B = [1,2,3]
print(A.loc[A['A'] &gt;= 5])

'''
Result:
     A
5    5
6    6
7    7
8    9
9   10
11   7
'''
</pre></div></div>
<p>
</p>
<div class="infoblock">
<div class="blocktitle">Problem 12</div>
<div class="blockcontent">
<p><tt>.to_csv()</tt> method
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 13</div>
<div class="blockcontent">
	<p>There are many descriptive statistics in <tt>Pandas</tt>. <tt>.describe()</tt> is also a candidate. <br/> Here is an example.
</p>
</div></div>
<div class="codeblock">
<div class="blockcontent"><pre>
A = pd.DataFrame([1,2,2,3,4,5,6,7,9,10,2,7], columns = ['A'])
Result = A.mean()
print(list(A.mean())[0])

'''
Result:
4.833333
'''
</pre></div></div>
<p>
</p>
<h2>Part 2: Data Preprocessing
</h2>
<p>
</p>
<div class="infoblock">
<div class="blocktitle">Problem 1</div>
<div class="blockcontent">
<p>There are two ways. Either just select all except the first column with <tt>.iloc()</tt> method. <br /> 

Either use <tt>.drop()</tt> method to select the column you want to delete with the column name. <br /> 

Here is an example.
</p>
</div></div>
<div class="codeblock">
<div class="blockcontent"><pre>
A = np.array([1,2,2,3,4,5,6,7,9,10,2,7]).reshape(3,4)
A = pd.DataFrame(A, columns = [0, 1, 2, 3])
A.drop(columns = 0, inplace = True) <span class = "comment"># Guess what is parameter inplace?</span>
print(A)

'''
Result:
    1  2  3
0   2  2  3
1   5  6  7
2  10  2  7
'''
</pre></div></div>
<p>
</p>
<div class="infoblock">
<div class="blockcontent">
<p>You could print <tt>A.columns</tt> for more information.
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 2</div>
<div class="blockcontent">
<p>This task requires you to create a pivot table, use <tt>.pivot_table()</tt> in <tt>Pandas</tt>. Here is an example.
</p>
</div></div>
<div class="codeblock">
<div class="blockcontent"><pre>
Table = {'date': ['2019/6/1', '2019/7/2', '2019/6/6', '2019/6/17', '2019/7/4', 
'2019/6/13', '2019/6/14', '2019/6/21', '2019/6/17'], 'order_id': [i+1 for i in range(9)],
'commodity_code': ['S1', 'S2', 'S3', 'S5', 'S5', 'S2', 'S9', 'S11', 'S9'], 'commodity_name': ['标准美式',
'瑞纳冰', '加浓美式', '拿铁', '拿铁', '瑞纳冰', '菠萝卷', '坚果', '菠萝卷'], 'category_name': ['饮品', 
'饮品', '饮品', '饮品', '饮品', '饮品', '食品', '食品', '食品']}
Table = pd.DataFrame(Table)
Result = pd.pivot_table(Table, index = 'category_name', columns = 'commodity_code', <br/> aggfunc = np.sum, fill_value = 0)
print(Result)

'''
Result:
	order_id
commodity_code	S1	S11	S2	S3	S5	S9
category_name
食品	0	8	0	0	0	16
饮品	1	0	8	3	9	0
'''
</pre></div></div>
<p>
</p>
<div class="infoblock">
<div class="blockcontent">
<p>Remember, the user should be identified by <i>Phone_No</i> and the items should be identified by <i>commodity_name</i>.
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 3</div>
<div class="blockcontent">
<p>None.
</p>
</div></div>
<h2>Part 3: Model Training and Prediction
</h2>
<div class="infoblock">
<div class="blocktitle">Problem 1</div>
<div class="blockcontent">
<p>None.
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 2</div>
<div class="blockcontent">
<p>Because you have changed the data into an <tt>array</tt>, you need to use selections methods in <tt>Numpy</tt>, which are a little different with those in <tt>Pandas</tt>. 

<br /> Here is an example.
</p>
</div></div>
<div class="codeblock">
<div class="blockcontent"><pre>
A = np.array([1,2,2,3,4,5,6,7,9,10,2,7]).reshape(3,4)
X, Y = A[:,0:3], A[:,3]
print(X, Y)

'''
Result:
[[ 1  2  2]
 [ 4  5  6]
 [ 9 10  2]] [3 7 7]
'''
</pre></div></div>
<p>
</p>
<div class="infoblock">
<div class="blocktitle">Problem 3</div>
<div class="blockcontent">
<p>You could find models <i>Adaboost</i>, <i>Random Forest</i> and also <i>Cross Validation</i> in <i>Sklearn</i>. <br /> See <a href="https://scikit-learn.org/stable/" target=&ldquo;blank&rdquo;>Sklearn Official Documentation</a> for more information.
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 3-a</div>
<div class="blockcontent">
<p><i>Xgboost</i> has unique data structures and training methods, see more information on <a href="https://xgboost.readthedocs.io/en/latest/python/python_intro.html" target=&ldquo;blank&rdquo;>Xgboost Python Tutorial</a>. 

<br /> You could also find <i>Xgboost</i> in <i>Sklearn</i>.
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 3-b</div>
<div class="blockcontent">
<p>When you ponder over this question, try to think from the following aspects: 

<br /> Characteristics of Data, Computational Complexity, Quality (Metrics) of the Model.
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 4</div>
<div class="blockcontent">
<p>This is the most difficult problem of this project and it is very time-consuming (at least one week) because there are many cases for you to consider. However, this is an open question, so no need to enumerate all possible outcomes just to find the best results.
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">Problem 5</div>
<div class="blockcontent">
<p>For every case you try in Problem 4, please record the result and the trend. Does the model behave better or worse? The performances will show you the hidden information of the data and you could use business intuition to explain the phenomenons. That is the answer of Problem 5.
</p>
</div></div>
<div class="infoblock">
<div class="blocktitle">FYI</div>
<div class="blockcontent">
<p>If you still find the problems hard to solve, read the articles or codes listed below thoroughly. <br /> 

<a href="https://zhuanlan.zhihu.com/p/83789325" target=&ldquo;blank&rdquo;>Python Data Analysis Notes: Part 1</a> <br /> 

<a href="https://zhuanlan.zhihu.com/p/86247866" target=&ldquo;blank&rdquo;>Python Data Analysis Notes: Part 2</a> <br /> 

<a href="WISERCLUB DataMining 1201.html" target=&ldquo;blank&rdquo;>WISERCLUB DataMining 1201 Notes </a> <br />
<a href="WISERCLUB DataMining 1215.html" target=&ldquo;blank&rdquo;>WISERCLUB DataMining 1215 Notes </a> <br />
<a href="Untitled1.html" target=&ldquo;blank&rdquo;>Numerical Experiments Notebook </a> <br/>
If you still find the problems hard to solve after reading, contact me by the email or WeChat. 
</p>
</div></div>
<div id="footer">
<div id="footer-text">
Page generated 2019-12-16 19:24:05 China Standard Time, by <a href="https://github.com/wsshin/jemdoc_mathjax" target="blank">jemdoc+MathJax</a>.
</div>
</div>
</div>
	</table>
</body>
</html>
